"use strict";
var a0_0x549e98 = a0_0x7a65;
(function (_0x46c189, _0x9c1ec9) {
  var _0x2cca5c = a0_0x7a65,
    _0x1b3dd5 = _0x46c189();
  while (!![]) {
    try {
      var _0x12ad06 =
        (-parseInt(_0x2cca5c(0xf7)) / 0x1) * (parseInt(_0x2cca5c(0xf9)) / 0x2) +
        parseInt(_0x2cca5c(0xee)) / 0x3 +
        (-parseInt(_0x2cca5c(0x106)) / 0x4) *
          (-parseInt(_0x2cca5c(0xd6)) / 0x5) +
        (parseInt(_0x2cca5c(0xdf)) / 0x6) * (parseInt(_0x2cca5c(0xe5)) / 0x7) +
        (-parseInt(_0x2cca5c(0x10a)) / 0x8) *
          (parseInt(_0x2cca5c(0xfc)) / 0x9) +
        (parseInt(_0x2cca5c(0x104)) / 0xa) *
          (-parseInt(_0x2cca5c(0xd5)) / 0xb) +
        parseInt(_0x2cca5c(0xce)) / 0xc;
      if (_0x12ad06 === _0x9c1ec9) break;
      else _0x1b3dd5["push"](_0x1b3dd5["shift"]());
    } catch (_0x126e7d) {
      _0x1b3dd5["push"](_0x1b3dd5["shift"]());
    }
  }
})(a0_0x4e35, 0xb1b3f);
var __awaiter =
    (this && this[a0_0x549e98(0xec)]) ||
    function (_0x542ce0, _0x297468, _0x2e9426, _0x1b1551) {
      function _0x44a98e(_0x4bb922) {
        return _0x4bb922 instanceof _0x2e9426
          ? _0x4bb922
          : new _0x2e9426(function (_0x1bda17) {
              _0x1bda17(_0x4bb922);
            });
      }
      return new (_0x2e9426 || (_0x2e9426 = Promise))(function (
        _0x301ff5,
        _0x37481a
      ) {
        var _0x1f3ecc = a0_0x7a65;
        function _0x30371d(_0x5e901d) {
          try {
            _0x232121(_0x1b1551["next"](_0x5e901d));
          } catch (_0x4927d8) {
            _0x37481a(_0x4927d8);
          }
        }
        function _0x2e236d(_0xf1d558) {
          try {
            _0x232121(_0x1b1551["throw"](_0xf1d558));
          } catch (_0x18904d) {
            _0x37481a(_0x18904d);
          }
        }
        function _0x232121(_0x57aea2) {
          var _0x19ae26 = a0_0x7a65;
          _0x57aea2[_0x19ae26(0xfd)]
            ? _0x301ff5(_0x57aea2["value"])
            : _0x44a98e(_0x57aea2["value"])["then"](_0x30371d, _0x2e236d);
        }
        _0x232121(
          (_0x1b1551 = _0x1b1551["apply"](_0x542ce0, _0x297468 || []))[
            _0x1f3ecc(0xf5)
          ]()
        );
      });
    },
  __generator =
    (this && this[a0_0x549e98(0x102)]) ||
    function (_0xf38d9b, _0x2cf917) {
      var _0x15c47f = a0_0x549e98,
        _0x24494c = {
          label: 0x0,
          sent: function () {
            if (_0x4d87e1[0x0] & 0x1) throw _0x4d87e1[0x1];
            return _0x4d87e1[0x1];
          },
          trys: [],
          ops: [],
        },
        _0xe29ad5,
        _0x444454,
        _0x4d87e1,
        _0x11d9dc;
      return (
        (_0x11d9dc = {
          next: _0x53f957(0x0),
          throw: _0x53f957(0x1),
          return: _0x53f957(0x2),
        }),
        typeof Symbol === _0x15c47f(0x10f) &&
          (_0x11d9dc[Symbol[_0x15c47f(0xf2)]] = function () {
            return this;
          }),
        _0x11d9dc
      );
      function _0x53f957(_0x465675) {
        return function (_0x163525) {
          return _0x361c70([_0x465675, _0x163525]);
        };
      }
      function _0x361c70(_0x20a843) {
        var _0x5e0e06 = _0x15c47f;
        if (_0xe29ad5) throw new TypeError(_0x5e0e06(0xea));
        while (
          (_0x11d9dc &&
            ((_0x11d9dc = 0x0), _0x20a843[0x0] && (_0x24494c = 0x0)),
          _0x24494c)
        )
          try {
            if (
              ((_0xe29ad5 = 0x1),
              _0x444454 &&
                (_0x4d87e1 =
                  _0x20a843[0x0] & 0x2
                    ? _0x444454[_0x5e0e06(0xed)]
                    : _0x20a843[0x0]
                    ? _0x444454[_0x5e0e06(0x10b)] ||
                      ((_0x4d87e1 = _0x444454[_0x5e0e06(0xed)]) &&
                        _0x4d87e1[_0x5e0e06(0xfb)](_0x444454),
                      0x0)
                    : _0x444454["next"]) &&
                !(_0x4d87e1 = _0x4d87e1[_0x5e0e06(0xfb)](
                  _0x444454,
                  _0x20a843[0x1]
                ))["done"])
            )
              return _0x4d87e1;
            if (((_0x444454 = 0x0), _0x4d87e1))
              _0x20a843 = [_0x20a843[0x0] & 0x2, _0x4d87e1["value"]];
            switch (_0x20a843[0x0]) {
              case 0x0:
              case 0x1:
                _0x4d87e1 = _0x20a843;
                break;
              case 0x4:
                _0x24494c["label"]++;
                return { value: _0x20a843[0x1], done: ![] };
              case 0x5:
                _0x24494c[_0x5e0e06(0xe1)]++,
                  (_0x444454 = _0x20a843[0x1]),
                  (_0x20a843 = [0x0]);
                continue;
              case 0x7:
                (_0x20a843 = _0x24494c[_0x5e0e06(0x10d)][_0x5e0e06(0xe0)]()),
                  _0x24494c["trys"][_0x5e0e06(0xe0)]();
                continue;
              default:
                if (
                  !((_0x4d87e1 = _0x24494c[_0x5e0e06(0xff)]),
                  (_0x4d87e1 =
                    _0x4d87e1[_0x5e0e06(0x101)] > 0x0 &&
                    _0x4d87e1[_0x4d87e1[_0x5e0e06(0x101)] - 0x1])) &&
                  (_0x20a843[0x0] === 0x6 || _0x20a843[0x0] === 0x2)
                ) {
                  _0x24494c = 0x0;
                  continue;
                }
                if (
                  _0x20a843[0x0] === 0x3 &&
                  (!_0x4d87e1 ||
                    (_0x20a843[0x1] > _0x4d87e1[0x0] &&
                      _0x20a843[0x1] < _0x4d87e1[0x3]))
                ) {
                  _0x24494c[_0x5e0e06(0xe1)] = _0x20a843[0x1];
                  break;
                }
                if (
                  _0x20a843[0x0] === 0x6 &&
                  _0x24494c[_0x5e0e06(0xe1)] < _0x4d87e1[0x1]
                ) {
                  (_0x24494c[_0x5e0e06(0xe1)] = _0x4d87e1[0x1]),
                    (_0x4d87e1 = _0x20a843);
                  break;
                }
                if (_0x4d87e1 && _0x24494c[_0x5e0e06(0xe1)] < _0x4d87e1[0x2]) {
                  (_0x24494c[_0x5e0e06(0xe1)] = _0x4d87e1[0x2]),
                    _0x24494c[_0x5e0e06(0x10d)][_0x5e0e06(0xf3)](_0x20a843);
                  break;
                }
                if (_0x4d87e1[0x2]) _0x24494c["ops"][_0x5e0e06(0xe0)]();
                _0x24494c[_0x5e0e06(0xff)][_0x5e0e06(0xe0)]();
                continue;
            }
            _0x20a843 = _0x2cf917["call"](_0xf38d9b, _0x24494c);
          } catch (_0x5650b6) {
            (_0x20a843 = [0x6, _0x5650b6]), (_0x444454 = 0x0);
          } finally {
            _0xe29ad5 = _0x4d87e1 = 0x0;
          }
        if (_0x20a843[0x0] & 0x5) throw _0x20a843[0x1];
        return {
          value: _0x20a843[0x0] ? _0x20a843[0x1] : void 0x0,
          done: !![],
        };
      }
    };
(exports.__esModule = true),
  (exports.signData = exports.encryptData = exports.decryptEnvelope = exports.encryptWithRWDKey = exports.generateKeyPair = exports.oprfOutput = void 0);
  var buffer_1 = require("buffer");
  var crypto_browserify_1 = require("crypto-browserify");
  var elliptic_1 = require("elliptic");
  var bn_js_1 = require("bn.js");
  var forge = require("node-forge");
function a0_0x7a65(_0x48f84b, _0x2dceeb) {
  var _0x4e35a0 = a0_0x4e35();
  return (
    (a0_0x7a65 = function (_0x7a6577, _0x2379ff) {
      _0x7a6577 = _0x7a6577 - 0xce;
      var _0x355fa2 = _0x4e35a0[_0x7a6577];
      return _0x355fa2;
    }),
    a0_0x7a65(_0x48f84b, _0x2dceeb)
  );
}
global.Buffer = buffer_1.Buffer;
var curve = new elliptic_1["ec"](a0_0x549e98(0xda));
function a0_0x4e35() {
  var _0x129ef = [
    "final",
    "function",
    "14323536adFYLy",
    "buffer",
    "getPrivate",
    "pointFromX",
    "encryptData",
    "publicKeyFromPem",
    "sha256",
    "6937227gdUpTp",
    "20cvabvx",
    "__esModule",
    "sent",
    "Buffer",
    "ed25519",
    "getPublic",
    "sign",
    "eddsa",
    "toDER",
    "71268HoWqtG",
    "pop",
    "label",
    "decryptEnvelope",
    "utf8",
    "createDecipher",
    "546bDXVRe",
    "encode",
    "createHash",
    "pki",
    "toString",
    "Generator\x20is\x20already\x20executing.",
    "encodeUtf8",
    "__awaiter",
    "return",
    "958257ZrrEJg",
    "signData",
    "update",
    "bn.js",
    "iterator",
    "push",
    "hex",
    "next",
    "concat",
    "442TlbwWm",
    "oprfOutput",
    "3778QQgkpL",
    "aes-256-gcm",
    "call",
    "23931enkGlC",
    "done",
    "node-forge",
    "trys",
    "from",
    "length",
    "__generator",
    "generateKeyPair",
    "20gSGWnj",
    "stringify",
    "1331196XJuzYf",
    "mul",
    "util",
    "genKeyPair",
    "2848FOFGyS",
    "throw",
    "charCodeAt",
    "ops",
  ];
  a0_0x4e35 = function () {
    return _0x129ef;
  };
  return a0_0x4e35();
}
function oprfOutput(_0x528b1e, _0x6dcab2) {
  var _0x381525 = a0_0x549e98,
    _0x5a84ce = new elliptic_1[_0x381525(0xdd)](_0x381525(0xda)),
    _0x419cbc = (0x0, crypto_browserify_1[_0x381525(0xe7)])(_0x381525(0xd4))
      [_0x381525(0xf0)](_0x528b1e)
      ["digest"](),
    _0x18f8cb = buffer_1[_0x381525(0xd9)]["from"](_0x419cbc),
    _0xc9594c = buffer_1[_0x381525(0xd9)][_0x381525(0x100)](_0x6dcab2, "hex"),
    _0xf32320 = _0x5a84ce["curve"][_0x381525(0xd1)](_0x18f8cb, !![]),
    _0x5afb1e = new bn_js_1["BN"](_0xc9594c),
    _0x18a9f6 = _0xf32320[_0x381525(0x107)](_0x5afb1e)[_0x381525(0xe6)](
      _0x381525(0xf4),
      ![]
    );
  return _0x18a9f6;
}
exports[a0_0x549e98(0xf8)] = oprfOutput;
function generateKeyPair() {
  var _0x1a2c66 = a0_0x549e98,
    _0x49bce8 = curve[_0x1a2c66(0x109)](),
    _0x4ff221 = _0x49bce8[_0x1a2c66(0xd0)](_0x1a2c66(0xf4)),
    _0x399555 = _0x49bce8[_0x1a2c66(0xdb)]("hex");
  return { privateKey: _0x4ff221, publicKey: _0x399555 };
}
exports[a0_0x549e98(0x103)] = generateKeyPair;
function encryptWithRWDKey(_0x5a68d0, _0x4173b2) {
  var _0x59dc03 = a0_0x549e98,
    _0x294dd3 = JSON[_0x59dc03(0x105)](_0x5a68d0),
    _0xa54ff4 = buffer_1[_0x59dc03(0xd9)][_0x59dc03(0x100)](
      _0x294dd3,
      _0x59dc03(0xe3)
    ),
    _0x3a0177 = (0x0, crypto_browserify_1["createCipher"])(
      _0x59dc03(0xfa),
      _0x4173b2
    ),
    _0x452505 = _0x3a0177[_0x59dc03(0xf0)](_0xa54ff4, null, _0x59dc03(0xf4));
  _0x452505 += _0x3a0177[_0x59dc03(0x10e)](_0x59dc03(0xf4));
  var _0x1f6c88 = _0x3a0177["getAuthTag"]()[_0x59dc03(0xe9)]("hex");
  return { encryptedEnvelope: _0x452505, authTag: _0x1f6c88 };
}
exports["encryptWithRWDKey"] = encryptWithRWDKey;
function decryptEnvelope(_0x52847f, _0x4a858e, _0x4a8d7f) {
  var _0xf3b045 = a0_0x549e98,
    _0x520bff = (0x0, crypto_browserify_1[_0xf3b045(0xe4)])(
      _0xf3b045(0xfa),
      _0x4a8d7f
    );
  _0x520bff["setAuthTag"](
    buffer_1["Buffer"][_0xf3b045(0x100)](_0x4a858e, _0xf3b045(0xf4))
  );
  var _0x5cb258 = _0x520bff[_0xf3b045(0xf0)](_0x52847f, _0xf3b045(0xf4));
  _0x5cb258 = buffer_1["Buffer"][_0xf3b045(0xf6)]([
    _0x5cb258,
    _0x520bff["final"](),
  ]);
  var _0x281afc = _0x5cb258[_0xf3b045(0xe9)](_0xf3b045(0xe3));
  return JSON["parse"](_0x281afc);
}
exports["decryptEnvelope"] = decryptEnvelope;
function pemToArrayBuffer(_0x1a0ccf) {
  var _0x1d6571 = a0_0x549e98,
    _0x5de72e = new ArrayBuffer(_0x1a0ccf[_0x1d6571(0x101)]),
    _0x5899be = new Uint8Array(_0x5de72e);
  for (
    var _0x148ba3 = 0x0, _0x1efef4 = _0x1a0ccf["length"];
    _0x148ba3 < _0x1efef4;
    _0x148ba3++
  ) {
    _0x5899be[_0x148ba3] = _0x1a0ccf[_0x1d6571(0x10c)](_0x148ba3);
  }
  return _0x5de72e;
}
function encryptData(_0x4423c3, _0x155bf0) {
  return __awaiter(this, void 0x0, void 0x0, function () {
    var _0x3060aa;
    return __generator(this, function (_0x40feb2) {
      var _0x5ab6a5 = a0_0x7a65;
      return (
        (_0x3060aa = forge[_0x5ab6a5(0xe8)]
          [_0x5ab6a5(0xd3)](_0x155bf0)
          ["encrypt"](forge[_0x5ab6a5(0x108)][_0x5ab6a5(0xeb)](_0x4423c3))),
        [0x2, forge["util"]["encode64"](_0x3060aa)]
      );
    });
  });
}
exports[a0_0x549e98(0xd2)] = encryptData;
function signData(_0x40bb40, _0x48ce4d) {
  return __awaiter(this, void 0x0, void 0x0, function () {
    var _0x39311f, _0x5c77fe;
    return __generator(this, function (_0x5cd91f) {
      var _0x2d13be = a0_0x7a65;
      switch (_0x5cd91f[_0x2d13be(0xe1)]) {
        case 0x0:
          _0x39311f = buffer_1[_0x2d13be(0xd9)][_0x2d13be(0x100)](
            _0x48ce4d,
            _0x2d13be(0xf4)
          );
          return [0x4, curve[_0x2d13be(0xdc)](_0x40bb40, _0x39311f)];
        case 0x1:
          _0x5c77fe = _0x5cd91f[_0x2d13be(0xd8)]();
          return [
            0x2,
            {
              data: _0x40bb40,
              signature: buffer_1[_0x2d13be(0xd9)]
                [_0x2d13be(0x100)](_0x5c77fe[_0x2d13be(0xde)]())
                [_0x2d13be(0xe9)]("hex"),
            },
          ];
      }
    });
  });
}
exports[a0_0x549e98(0xef)] = signData;
